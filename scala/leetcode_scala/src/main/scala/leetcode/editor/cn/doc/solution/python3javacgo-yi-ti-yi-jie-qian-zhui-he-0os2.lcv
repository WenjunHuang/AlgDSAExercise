**æ–¹æ³•ä¸€ï¼šå‰ç¼€å’Œ + å“ˆå¸Œè¡¨**

æˆ‘ä»¬å¯ä»¥åˆ©ç”¨å‰ç¼€å’Œçš„æ€æƒ³ï¼Œç»´æŠ¤ä¸€ä¸ªå˜é‡ $s$ï¼Œè¡¨ç¤ºä»ä¸‹æ ‡ $0$ åˆ°å½“å‰ä¸‹æ ‡çš„è¿™ä¸€æ®µï¼Œã€ŒåŠ³ç´¯çš„å¤©æ•°ã€ä¸ã€Œä¸åŠ³ç´¯çš„å¤©æ•°ã€çš„å·®å€¼ã€‚å¦‚æœ $s$ å¤§äº $0$ï¼Œè¯´æ˜ä»ä¸‹æ ‡ $0$ åˆ°å½“å‰ä¸‹æ ‡çš„è¿™ä¸€æ®µï¼Œæ»¡è¶³ã€Œè¡¨ç°è‰¯å¥½çš„æ—¶é—´æ®µã€ã€‚å¦å¤–ï¼Œç”¨å“ˆå¸Œè¡¨ $pos$ è®°å½•æ¯ä¸ª $s$ ç¬¬ä¸€æ¬¡å‡ºç°çš„ä¸‹æ ‡ã€‚

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬éå†æ•°ç»„ $hours$ï¼Œå¯¹äºæ¯ä¸ªä¸‹æ ‡ $i$ï¼š

- å¦‚æœ $hours[i] \gt 8$ï¼Œæˆ‘ä»¬å°±è®© $s$ åŠ  $1$ï¼Œå¦åˆ™å‡ $1$ã€‚
- å¦‚æœ $s$ å¤§äº $0$ï¼Œè¯´æ˜ä»ä¸‹æ ‡ $0$ åˆ°å½“å‰ä¸‹æ ‡çš„è¿™ä¸€æ®µï¼Œæ»¡è¶³ã€Œè¡¨ç°è‰¯å¥½çš„æ—¶é—´æ®µã€ï¼Œæˆ‘ä»¬æ›´æ–°ç»“æœ $ans = i + 1$ã€‚å¦åˆ™ï¼Œå¦‚æœ $s - 1$ åœ¨å“ˆå¸Œè¡¨ $pos$ ä¸­ï¼Œè®° $j = pos[s - 1]$ï¼Œè¯´æ˜ä»ä¸‹æ ‡ $j + 1$ åˆ°å½“å‰ä¸‹æ ‡ $i$ çš„è¿™ä¸€æ®µï¼Œæ»¡è¶³ã€Œè¡¨ç°è‰¯å¥½çš„æ—¶é—´æ®µã€ï¼Œæˆ‘ä»¬æ›´æ–°ç»“æœ $ans = max(ans, i - j)$ã€‚
- å¦‚æœ $s$ ä¸åœ¨å“ˆå¸Œè¡¨ $pos$ ä¸­ï¼Œæˆ‘ä»¬å°±è®°å½• $pos[s] = i$ã€‚ç»§ç»­éå†ä¸‹ä¸€ä¸ªã€‚

éå†ç»“æŸåï¼Œè¿”å›ç­”æ¡ˆå³å¯ã€‚

* [sol1-Python3]

```python
class Solution:
    def longestWPI(self, hours: List[int]) -> int:
        ans = s = 0
        pos = {}
        for i, x in enumerate(hours):
            s += 1 if x > 8 else -1
            if s > 0:
                ans = i + 1
            elif s - 1 in pos:
                ans = max(ans, i - pos[s - 1])
            if s not in pos:
                pos[s] = i
        return ans
```

* [sol1-Java]

```java
class Solution {
    public int longestWPI(int[] hours) {
        int ans = 0, s = 0;
        Map<Integer, Integer> pos = new HashMap<>();
        for (int i = 0; i < hours.length; ++i) {
            s += hours[i] > 8 ? 1 : -1;
            if (s > 0) {
                ans = i + 1;
            } else if (pos.containsKey(s - 1)) {
                ans = Math.max(ans, i - pos.get(s - 1));
            }
            pos.putIfAbsent(s, i);
        }
        return ans;
    }
}
```

* [sol1-C++]

```cpp
class Solution {
public:
    int longestWPI(vector<int>& hours) {
        int ans = 0, s = 0;
        unordered_map<int, int> pos;
        for (int i = 0; i < hours.size(); ++i) {
            s += hours[i] > 8 ? 1 : -1;
            if (s > 0) {
                ans = i + 1;
            } else if (pos.count(s - 1)) {
                ans = max(ans, i - pos[s - 1]);
            }
            if (!pos.count(s)) {
                pos[s] = i;
            }
        }
        return ans;
    }
};
```

* [sol1-Go]

```go
func longestWPI(hours []int) (ans int) {
	s := 0
	pos := map[int]int{}
	for i, x := range hours {
		if x > 8 {
			s++
		} else {
			s--
		}
		if s > 0 {
			ans = i + 1
		} else if j, ok := pos[s-1]; ok {
			ans = max(ans, i-j)
		}
		if _, ok := pos[s]; !ok {
			pos[s] = i
		}
	}
	return
}

func max(a, b int) int {
	if a > b {
		return a
	}
	return b
}
```

æ—¶é—´å¤æ‚åº¦ $O(n)$ï¼Œç©ºé—´å¤æ‚åº¦ $O(n)$ã€‚å…¶ä¸­ $n$ ä¸ºæ•°ç»„ $hours$ çš„é•¿åº¦ã€‚

---

æœ‰ä»»ä½•é—®é¢˜ï¼Œæ¬¢è¿è¯„è®ºåŒºäº¤æµï¼Œæ¬¢è¿è¯„è®ºåŒºæä¾›å…¶å®ƒè§£é¢˜æ€è·¯ï¼ˆä»£ç ï¼‰ï¼Œä¹Ÿå¯ä»¥ç‚¹ä¸ªèµæ”¯æŒä¸€ä¸‹ä½œè€…å“ˆğŸ˜„~
